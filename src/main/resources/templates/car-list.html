<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{layout/headerLog :: headerLog}"></div>
<body class="custom-cursor">
<div class="custom-cursor__cursor"></div>
<div class="custom-cursor__cursor-two"></div>

<!--Start Preloader-->
<div class="loader js-preloader">
    <div></div>
    <div></div>
    <div></div>
</div>
<!--End Preloader-->



<div class="page-wrapper">
    <div th:replace="~{layout/navbar :: navbar}"></div>
    <div class="stricky-header stricked-menu main-menu">
        <div class="sticky-header__content"></div><!-- /.sticky-header__content -->
    </div>

    <section class="page-header">
        <div class="page-header__bg"
             th:style="'background-image: url(' + @{/assets/images/backgrounds/page-header-bg.jpg} + ');'">
        </div>

        <div class="page-header__shape-1"
             th:style="'background-image: url(' + @{/assets/images/shapes/page-header-shape-1.png} + ');'">
        </div>

    </section>
    <!--Page Header End -->

    <!--Car Listing page One Start -->
    <section class="car-listing-page-one">
        <div class="container">
            <div class="row"><!-- MAIN ROW -->

                <!-- LEFT COLUMN: CAR LIST -->
                <div class="col-xl-9">
                    <div class="car-listing-page-one__left">
                        <div class="row g-4" id="carList">


                            <!-- SINGLE CAR CARD -->
                            <div class="col-xl-4 col-lg-4 col-md-6" th:each="car : ${carListViewDto.cars}">
                            <div class="listing-one__single">
                                <!-- IMAGE -->
                                <div class="listing-one__img">
                                    <img th:src="${#lists.isEmpty(car.imageUrls)
                                              ? '/assets/images/placeholder-car.jpg'
                                              : car.imageUrls.get(0)}"
                                         alt="Car image"
                                         style="width:410px; height:250px; object-fit:cover; display:block;">
                                    <div class="listing-one__brand-name">
                                        <p th:text="${car.name}" class="car-name">Car Name</p>
                                    </div>
                                </div>

                                <!-- CONTENT -->
                                <div class="listing-one__content">
                                    <h3 class="listing-one__title">
                                        <a th:href="@{/car-detail/{id}(id=${car.id})}" th:text="${car.name}">
                                            Car Title
                                        </a>
                                    </h3>
                                    <!-- META INFO -->
                                    <div class="listing-one__meta-box-info">
                                        <ul class="list-unstyled listing-one__meta">
                                            <!-- Transmission -->
                                            <li>
                                                <div class="icon"><span class="icon-manual"></span></div>
                                                <div class="text"><p th:text="${car.transmission}">Manual</p></div>
                                            </li>

                                            <!-- Drive Type -->
                                            <li>
                                                <div class="icon"><span class="icon-mileage"></span></div>
                                                <div class="text"><p th:text="${car.driveType}">AWD</p></div>
                                            </li>

                                            <!-- Fuel Type -->
                                            <li>
                                                <div class="icon"><span class="icon-fuel-type"></span></div>
                                                <div class="text"><p th:text="${car.fuelType}">Gasoline</p></div>
                                            </li>

                                            <!-- Engine Size -->
                                            <li>
                                                <div class="icon"><span class="icon-engine"></span></div>
                                                <div class="text"><p th:text="${car.engineSize}">2.0L</p></div>
                                            </li>

                                            <!-- Seats -->
                                            <li>
                                                <div class="icon"><span class="icon-seat"></span></div>
                                                <div class="text"><p th:text="${car.seat} + ' Seats'">5 Seats</p></div>
                                            </li>

                                            <!-- Production Year -->
                                            <li>
                                                <div class="icon"><span class="icon-calendar"></span></div>
                                                <div class="text"><p th:text="${car.productionYear}">2022</p></div>
                                            </li>

                                            <!-- Price -->
                                            <li>
                                                <div class="icon"><span class="icon-price">$ </span></div>
                                                <div class="text"><p th:text="${#numbers.formatDecimal(car.price, 0, 'COMMA', 0, 'POINT')}  "></p></div>
                                            </li>
                                        </ul>


                                    </div>
                                </div><!-- /.listing-one__content -->

                                <!-- BUTTON -->
                                <div class="listing-one__btn-box d-flex justify-content-between">
                                    <a th:href="@{/car-detail/{id}(id=${car.id})}"
                                       class="thm-btn flex-fill me-2 text-center">
                                        Details
                                    </a>
                                    <form th:action="@{/compare/add}" method="post" class="flex-fill"
                                          th:with="selectedIds=${session.compareIds}">
                                        <input type="hidden" name="id" th:value="${car.id}" />
                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                        <button type="submit"
                                                class="thm-btn w-100 text-center"
                                                th:disabled="${selectedIds != null and selectedIds.contains(car.id)}"
                                                th:text="${(selectedIds != null and selectedIds.contains(car.id)) ? 'Added' : 'Compare'}">
                                            Compare
                                        </button>
                                    </form>
                                </div>


                            </div><!-- /.listing-one__single -->
                        </div><!-- /.col -->

                        </div><!-- /.row g-4 -->
                    </div><!-- /.car-listing-page-one__left -->
                </div><!-- /.col-xl-9 -->

                <!-- RIGHT COLUMN: SIDEBAR -->
                <div class="col-xl-3">
                    <div class="car-listing-page-one__right">
                        <form th:action="@{/carList}" method="get" id="filterForm">

                            <!-- name search -->
                            <div class="car-listing__search car-listing__sidebar-single">
                                <input id="filterName" type="text" name="name" placeholder="Search"
                                       th:value="${selectedName}">
                                <button type="submit"><i class="fa fa-search"></i></button>
                            </div>

                            <!-- price -->
                            <div class="car-listing__price-ranger car-listing__sidebar-single">
                                <h3 class="car-listing__sidebar-title">Filter Price</h3>
                                <div class="price-ranger">
<!--                                    <div id="slider-range"></div>-->
                                    <div class="ranger-min-max-block">
                                        <input type="number" class="min" name="minPrice"
                                               th:value="${selectedMinPrice}"
                                               th:placeholder="${carListViewDto.minPrice}">
                                        <span>-</span>
                                        <input type="number" class="max" name="maxPrice"
                                               th:value="${selectedMaxPrice}"
                                               th:placeholder="${carListViewDto.maxPrice}">
                                        <input type="submit" value="Filter">
                                    </div>


                                </div>
                            </div>

                            <!-- brand -->
                            <div class="car-listing__category car-listing__sidebar-single">
                                <h3 class="car-listing__sidebar-title">Brands</h3>
                                <select name="brandId" class="form-select">
                                    <option value="">All</option>
                                    <option th:each="b : ${carListViewDto.carBrands}"
                                            th:value="${b.brandId}"
                                            th:text="${b.brandName}"
                                            th:selected="${selectedBrandId != null and selectedBrandId == b.brandId}">
                                    </option>
                                </select>
                            </div>

                            <!-- type -->
                            <div class="car-listing__category car-listing__sidebar-single">
                                <h3 class="car-listing__sidebar-title">Car Type</h3>
                                <select name="typeId" class="form-select">
                                    <option value="">All</option>
                                    <option th:each="t : ${carListViewDto.types}"
                                            th:value="${t.typeId}"
                                            th:text="${t.typeName}"
                                            th:selected="${selectedTypeId != null and selectedTypeId == t.typeId}">
                                    </option>
                                </select>
                            </div>

                            <!-- fuel -->
                            <div class="car-listing__category car-listing__sidebar-single">
                                <h3 class="car-listing__sidebar-title">Fuel Type</h3>
                                <select name="fuel" class="form-select" th:value="${selectedFuel}">
                                    <option value="">All</option>
                                    <option>Gasoline</option>
                                    <option>Diesel</option>
                                    <option>Hybrid</option>
                                    <option>Plug-in Hybrid</option>
                                    <option>Electric</option>
                                </select>
                            </div>

                            <!-- features (multi) -->
                            <div class="car-listing__category car-listing__features car-listing__sidebar-single">
                                <h3 class="car-listing__sidebar-title">Car Features</h3>
                                <ul class="list-unstyled">
                                    <li th:each="f : ${carListViewDto.features}">
                                        <div class="checked-box">
                                            <input type="checkbox"
                                                   th:id="'feat-' + ${f.id}"
                                                   name="featureIds"
                                                   th:value="${f.id}"
                                                   th:checked="${selectedFeatureIds != null and selectedFeatureIds.contains(f.id)}">
                                            <label th:for="'feat-' + ${f.id}" th:text="${f.name}">Feature</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>

                            <button type="submit" class="thm-btn w-100">Apply Filters</button>
                            <a th:href="@{/carList}" class="btn btn-link w-100 mt-2">Clear</a>
                        </form><!-- /.car-listing__sidebar -->
                    </div><!-- /.car-listing-page-one__right -->
                </div><!-- /.col-xl-3 -->

            </div><!-- /.row -->
    </section>
    <!--Car Listing page One End -->

    <!--Gallery One Start -->

    <!--Gallery One End -->

    <!--Site Footer Start-->
    <footer class="site-footer">
        <div class="site-footer__bg" style="background-image: url(assets/images/backgrounds/site-footer-bg.jpg);">
        </div>
        <div class="site-footer__top">

        </div>
        <div class="site-footer__bottom">
            <div class="container">
            </div>
        </div>
    </footer>
    <!--Site Footer End-->




</div><!-- /.page-wrapper -->


<div class="mobile-nav__wrapper">
    <div class="mobile-nav__overlay mobile-nav__toggler"></div>
    <!-- /.mobile-nav__overlay -->
    <div class="mobile-nav__content">
        <span class="mobile-nav__close mobile-nav__toggler"><i class="fa fa-times"></i></span>

        <div class="logo-box">
            <a href="index.html" aria-label="logo image"><img src="assets/images/resources/logo-2.png" width="140"
                                                              alt="" /></a>
        </div>
        <!-- /.logo-box -->
        <div class="mobile-nav__container"></div>
        <!-- /.mobile-nav__container -->

        <ul class="mobile-nav__contact list-unstyled">
            <li>
                <i class="fa fa-envelope"></i>
                <a href="mailto:needhelp@packageName__.com">needhelp@gorent.com</a>
            </li>
            <li>
                <i class="fas fa-phone"></i>
                <a href="tel:666-888-0000">666 888 0000</a>
            </li>
        </ul><!-- /.mobile-nav__contact -->
        <div class="mobile-nav__top">
            <div class="mobile-nav__social">
                <a href="#" class="fab fa-twitter"></a>
                <a href="#" class="fab fa-facebook-square"></a>
                <a href="#" class="fab fa-pinterest-p"></a>
                <a href="#" class="fab fa-instagram"></a>
            </div><!-- /.mobile-nav__social -->
        </div><!-- /.mobile-nav__top -->



    </div>
    <!-- /.mobile-nav__content -->
</div>
<!-- /.mobile-nav__wrapper -->

<div class="search-popup">
    <div class="search-popup__overlay search-toggler"></div>
    <!-- /.search-popup__overlay -->
    <div class="search-popup__content">
        <form action="#">
            <label for="searchInput" class="sr-only">search here</label><!-- /.sr-only -->
            <input type="text" id="searchInput" placeholder="Search Here..." />
            <button type="submit" aria-label="search submit" class="thm-btn">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>
    <!-- /.search-popup__content -->
</div>
<!-- /.search-popup -->

<a href="#" data-target="html" class="scroll-to-target scroll-to-top">
    <span class="scroll-to-top__wrapper"><span class="scroll-to-top__inner"></span></span>
    <span class="scroll-to-top__text"> Go Back Top</span>
</a>

<script src="assets/js/jquery-3.6.0.min.js"></script>
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/jarallax.min.js"></script>
<script src="assets/js/jquery.ajaxchimp.min.js"></script>
<script src="assets/js/jquery.appear.min.js"></script>
<script src="assets/js/swiper.min.js"></script>
<script src="assets/js/jquery.circle-progress.min.js"></script>
<script src="assets/js/knob.js"></script>
<script src="assets/js/jquery.magnific-popup.min.js"></script>
<script src="assets/js/jquery.validate.min.js"></script>
<script src="assets/js/wNumb.min.js"></script>
<script src="assets/js/wow.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/jquery-ui.js"></script>
<script src="assets/js/jquery.nice-select.min.js"></script>
<script src="assets/js/jquery-sidebar-content.js"></script>
<script src="assets/js/gsap/gsap.js"></script>
<script src="assets/js/gsap/ScrollTrigger.js"></script>
<script src="assets/js/gsap/SplitText.js"></script>
<script src="assets/js/marquee.min.js"></script>
<script src="assets/js/odometer.min.js"></script>
<script src="assets/js/timePicker.js"></script>
<script src="assets/js/typed-2.0.11.js"></script>
<script src="assets/js/aos.js"></script>
<!-- template js -->
<script src="assets/js/script.js"></script>
<script>
    // If you use jQuery UI slider:
    // $('#slider-range').slider({ ... update the two inputs named minPrice/maxPrice ... });

    // Auto-submit when brand/type/fuel change
    document.querySelectorAll('select[name="brandId"], select[name="typeId"], select[name="fuel"]')
        .forEach(el => el.addEventListener('change', () => document.getElementById('filterForm').submit()));

    // Debounced name search (enter key or short delay)
    const search = document.getElementById('searchInput');
    let t;
    search.addEventListener('keyup', () => {
        clearTimeout(t);
        t = setTimeout(() => document.getElementById('filterForm').submit(), 400);
    });
    (function () {
        const form  = document.getElementById('filterForm');
        const input = document.getElementById('filterName');

        // Submit on Enter
        input.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                if (form.requestSubmit) form.requestSubmit(); else form.submit();
            }
        });

        // Auto-submit select filters
        document.querySelectorAll('select[name="brandId"], select[name="typeId"], select[name="fuel"]')
            .forEach(el => el.addEventListener('change', () => {
                if (form.requestSubmit) form.requestSubmit(); else form.submit();
            }));
    })();

</script>


</body>

</html>